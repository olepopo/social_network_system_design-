**ПРОФИЛЬ**

Хранение:
* Имя (50b)
* Фамилия (50b)
* Аватарка (1Mb)
* Местонахождение (16b)
* Итого:  ~1Mb
Пользователь в среднем просматривает 5 аккаунтов/профилей в день

Расчет нагрузки:
DAU = 10 000 000. Предположим регестрируется только 0,2% от DAU
RPS по регистрации новых аккаунтов = 2 000 000 / 86 400 = 23
Трафик по регистрации новых аккаунтов = 23 * 1Mb = 23Mb/sec

RPS по просмотру аккаунтов = (10 000 000 * 5) / 86 400 = 575
Трафик по просмотру аккаунтов = 575 * 1Mb = 575Mb/sec

Расчет количества дисков для хранения данных на 1 год:
Прирост данных в год по аккаунтам: 23Mb/sec * 86 400 * 365 = ~725Tb/year
IOPS = 1 (write) + 575 (read) = 575
Трафик = 23Mb/sec (write) + 575Mb/sec (read) = 598Mb/sec

Для HDD:
Disks_for_capacity = 725Tb / 32Tb = ~23
Disks_for_throughput =  598Mb/sec / 100Mb/sec = ~6
Disks_for_iops = 575 / 100 = ~6
Disks = 23

Для SSD (SATA):
Disks_for_capacity = 725Tb / 100Tb = ~7
Disks_for_throughput = 598Mb/sec / 500Mb/sec = ~2
Disks_for_iops = 575 / 1 000 = ~0,5
Disks = 7

Выбирается 7 SSD (SATA) диска

_________________________________


**ПОДПИСКА** 

Хранение:
* Не более 1 000 000 подписчиков
* Новых подписок в день: 10 000 000 (DAU) * 0.1 = 1 000 000
* Вес информации о подписке = ~50b
* Пользователь в среднем просматривает подписки (на кого подписан и кто подписан на него) 5 раз в день

RPS подписаться на путешественника = 1 000 000 / 86 400 = ~12
Трафик по подпискам = 12 * 50b = ~1Kb/sec
RPS по просмотру подписок = ( (10 000 000 * 5) / 86 400 )  = ~800
Трафик по просмотру подписок = 600 * 50b  = 400Kb/sec

Прирост данных в год по подпискам = 1Kb/sec * 86 400 * 365 = 30Gb/year
IOPS = 12 (write) + 800 (read) = ~800
Трафик = 1Kb/sec (write) + 400Kb/sec (read) = ~400Kb/sec

Для SSD (nVME):
Disks_for_capacity = 30Gb / 30Tb = 1
Disks_for_throughput = 400Kb/sec / 3Gb/sec = 0,01
Disks_for_iops = 800 / 10 000 = 0.1
Disks = 1

Выбирается 1 SSD (SATA) диска.


_________________________________
**СООБЩЕНИЯ**

Хранение:
    * Фото/аттач: 1Mb
    * Текст/контент: 100b
    * Итого: ~1Mb

* 1 пользователь пишет 10 сообщений в день, из них 3 с фото
* 1 пользователь читает 20 сообщений в день 

RPS по отправке сообщений = (10 000 000 * 10) / 86 400 = ~1 150
Трафик по отправке сообщений = (2 300 * (3/10) * 1Mb) + (2 300 * 100b) = 170Mb + 0.23Mb = ~170Mb/sec
RPS по просмотру сообщений = ((10 000 000 * 20) / 86 400) = ~2 300
Трафик по просмотру сообщений = (7 000 * (3/20) * 1Mb) + (10 500 * 100b))  = 1000Mb + 1Mb = ~1Gb/sec


Прирост данных в год по сообщениям = 170Mb/sec * 86 400 * 365 = ~5 000 Tb/year
IOPS =1 150 (write) + 2 300 (read) = ~3 500
Трафик = 170Mb/sec (write) + 1Gb/sec (read) = ~1Gb/sec

Для HDD (nVME):
Disks_for_capacity = 5 000Tb / 32Tb = 150
Disks_for_throughput = 1Gb/sec / 100Mb/sec = 10
Disks_for_iops = 3 500 / 100 = 35
Disks = 150

Для SSD (SATA):
Disks_for_capacity = 5 000Tb / 100Tb = 100
Disks_for_throughput = 1Gb/sec / 500Mb/sec = 20
Disks_for_iops =  3 500  / 1 000 = 3,5
Disks = 100


Выбирается 100 SSD (SATA)

_________________________________
**ПУБЛИКАЦИЯ ПОСТА**

Содержимое поста:
    * Заголовок 100b
    * Обложка: 200Kb
    * Описание: 50Kb
    * Фотографии
        * В среднем кол-во = 3
        * В среднем = 1Mb
        * Итого: = 3Mb
    * Локация (8b)
    * Итого, в среднем:
        * Только картинки = ~3Mb
        * Данные без картинок = ~50Kb


1 пользователь 1 пост в день создает, значит 10 000 000 постов каждый день на создание
1 пользователь смотрит 30 постов в день 
Запись к чтению = 1 к 30 (пост), значит 300 000 000 постов каждый день на чтение


RPS опубликовать новый пост = (10 000 000 ) / 86 400  = ~115
Трафик по публикации новых постов:
* Только картинки = 115 * 3Mb = ~350Mb/sec
* Данные без картинок = 115 * 50Kb = ~600Kb/sec

RPS по просмотру постов = (10 000 000 *30 ) / 86 400 = ~3500
Трафик по просмотру постов:
* Только картинки = 3500 * 3Mb= ~10Gb/sec
* Данные без картинок = 350 * 50Kb = ~17Mb/sec

* Только картинки = 350Mb * 86 400 * 365 = ~11 0370Tb/year
* Данные без картинок = 600Kb/sec * 86 400 * 365 = ~18Tb/year
IOPS = 115 (write) + 3500 (read, просмотр постов)  = 3 600

Трафик:
* Только картинки = 350Mb/sec (write) + 10Gb/sec (read, просмотр постов)  = ~10Gb/sec
* Данные без картинок: 600Kb/sec (write) + 17Mb/sec (read, просмотр постов)  = ~17Mb/sec

- Только картинки:
Для SSD (SATA):
Disks_for_capacity = 11 0370 Tb / 100Tb = 1 103
Disks_for_throughput = 100 000Mb/sec / 500Mb/sec = 200
Disks_for_iops = 3 600/ 1 000 = 3,6
Disks = 1 103


Данные без картинок
Для SSD (SATA):
Disks_for_capacity = 18Tb/ 100Tb =  0,18
Disks_for_throughput = 17Mb/sec / 500Mb/sec = 0,034
Disks_for_iops = 3 600/ 1 000 = 3,6
Disks = 3,6
 
Выбирается 4 SSD (SATA)
